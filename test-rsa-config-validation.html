<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSAé…ç½®éªŒè¯ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 25px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            background-color: #ffffff;
        }
        .result-card {
            margin: 15px 0;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 14px;
        }
        .success { background-color: #d4edda; border-left: 4px solid #28a745; }
        .error { background-color: #f8d7da; border-left: 4px solid #dc3545; }
        .warning { background-color: #fff3cd; border-left: 4px solid #ffc107; }
        .info { background-color: #d1ecf1; border-left: 4px solid #17a2b8; }
        textarea, input { 
            width: 100%; 
            padding: 10px; 
            margin: 8px 0; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
            font-family: monospace;
        }
        button {
            padding: 12px 24px;
            margin: 5px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 16px;
        }
        button:hover { background: #0056b3; }
        .config-display {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ RSAé…ç½®éªŒè¯ä¿®å¤æµ‹è¯•</h1>
        <p>æµ‹è¯•ä¿®å¤åçš„RSAé…ç½®éªŒè¯é€»è¾‘æ˜¯å¦èƒ½æ­£ç¡®è¯†åˆ«æœ‰æ•ˆçš„RSAé…ç½®</p>
        
        <div class="test-section">
            <h3>ğŸ“‹ æµ‹è¯•ç”¨ä¾‹</h3>
            <div class="config-display">
                <strong>ç”¨æˆ·æŠ¥å‘Šçš„é—®é¢˜:</strong><br>
                "é…ç½® rsa è§£å¯†å‡ºé”™: Error: RSAè§£å¯†éœ€è¦æä¾›ç§é’¥"<br><br>
                
                <strong>é—®é¢˜åˆ†æ:</strong><br>
                AutoCipherToolä¸­çš„isValidConfigå‡½æ•°å¯¹RSAé…ç½®çš„éªŒè¯é€»è¾‘ä¸æ­£ç¡®<br>
                åŸé€»è¾‘: config.privateKey (æ£€æŸ¥å¯¹è±¡æ˜¯å¦å­˜åœ¨)<br>
                ä¿®å¤å: config.privateKey.value && config.privateKey.value.trim() (æ£€æŸ¥å®é™…å€¼)<br><br>
                
                <strong>æµ‹è¯•å¯†æ–‡:</strong><br>
                A6zfp+TG4VH8Lf+xKISInZEcdc6klF5iS8kTzN1PktwE4cgEhzrbJ5dE6a/yrIoLZDIdxM6zmLzZe1h3u/YORrUTkxwusksnxzy9r7Uk3qKquR1zkBE9MdKP1BU5hkE9PP+g2EEnv+Wm46kf8MfPwohnKPnSNjCBdKskJ4fhNIpYh+2o5qqLmJhI7pvyjpr46d+2OQDSMv6xRhyRd+WsgzyudLYs8QiZrReqAQ09dDEyiJjyPrGPDGD2zsLjzHDpL6Eu9+mnGkugRYGPkgrScDySvijOoySr3nXeeimzayL61sIQ3Vjv9EvkQIQPvvHjqRonVGpfemitMuJWsUFDWw==
            </div>
            
            <button onclick="runValidationTests()">ğŸ§ª è¿è¡ŒéªŒè¯æµ‹è¯•</button>
            <button onclick="testActualDecryption()">ğŸ”“ æµ‹è¯•å®é™…è§£å¯†</button>
            <button onclick="clearResults()">ğŸ—‘ï¸ æ¸…ç©ºç»“æœ</button>
            <div id="validationResults"></div>
        </div>

        <div class="test-section">
            <h3>âš™ï¸ è‡ªå®šä¹‰é…ç½®æµ‹è¯•</h3>
            <div>
                <label>é…ç½®åç§°:</label>
                <input type="text" id="configName" value="æµ‹è¯•RSAé…ç½®" placeholder="é…ç½®åç§°">
            </div>
            <div>
                <label>ç§é’¥å€¼:</label>
                <textarea id="privateKey" rows="4" placeholder="è¯·è¾“å…¥RSAç§é’¥...">-----BEGIN PRIVATE KEY-----
MIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBAKoYq6Q7UN7vOFmPr4fSq2NORXHB
MKm8p7h4JnQU+quLRxvYll9cn8OBhIXq9SnCYkbzBVBkqN4ZyMM4vlSWy66wWdwLNYFDtEo1RJ6y
ZBExIaRVvX/eP6yRnpS1b7m7T2Uc2yPq1DnWzVI+sIGR51s1/ROnQZswkPJHh71PThlnAgMBAAEC
gYEA45gzQLi7hAfVhRictua2AlY9gfLZmwQ4WzcJaYisqMZDuBoA1KUmga8sHM7HHftzsdc+7Ulv
4nx4i3oAqxk7a13D7mB9E+z3H+w0ZupLxQuKjfV8V0vzEOMiOktTWmDdRF6XlQqpcdbt088Hnf7Y
33gH3ZcQ5WwDHQz1KufyDzECQQDQ3D95c3r+woW5aG/te0AhdRDGRovARLXt6MFeK9hCDsYQzHpU
8PoDm/oUg5OAFPCkp3ZxWRZFhZfx65d32mtFAkEAwHZPJA3OdXIrhK4bvJy5rR+hxWNn8jNhg0fT
0Q8jdz87aD8NFjJi17AgbS7WQP7wHn7sDRrNLwGC7fbsDyO1CQJBAJw1oObdyRxmRqbU6LLkoeUM
mGYwRHuC9k0HlWgF4WsiJHdk9v/gK1dXyGX6gtxJxaE0x3W4i9JlUVrkKZf3QUICQDFPJ988NBFs
XOUK5CvwkWh7UdRYvJ7X6FN9bGM7zjGHvlgLKEJuacwqVx1DkCEc3h76ZYIgDlJ81s4j0dECQQCs
pG7VqXge3NjhP8SzC2G2A202R07rjd8pWWrcwFk9JtJvW4mZESxQZlKTbF4A2FZ9F7G0jvJXJeqm
00ywl3J9
-----END PRIVATE KEY-----</textarea>
            </div>
            <button onclick="testCustomConfig()">ğŸ§ª æµ‹è¯•è‡ªå®šä¹‰é…ç½®</button>
            <div id="customResults"></div>
        </div>
    </div>

    <script>
        // ä¿®å¤åçš„é…ç½®éªŒè¯å‡½æ•°ï¼ˆæ¨¡æ‹ŸAutoCipherToolä¸­çš„é€»è¾‘ï¼‰
        function isValidConfig(config) {
            if (!config || !config.name) return false;
            if (config.algorithm?.startsWith('RSA')) {
                // RSAé…ç½®éœ€è¦æ£€æŸ¥ç§é’¥å¯¹è±¡åŠå…¶å€¼
                return config.privateKey && config.privateKey.value && config.privateKey.value.trim();
            } else {
                return config.key && config.key.value;
            }
        }

        // åŸå§‹çš„é”™è¯¯éªŒè¯å‡½æ•°ï¼ˆç”¨äºå¯¹æ¯”ï¼‰
        function isValidConfigOld(config) {
            if (!config || !config.name) return false;
            if (config.algorithm?.startsWith('RSA')) {
                return config.publicKey && config.privateKey;
            } else {
                return config.key && config.key.value;
            }
        }

        // æµ‹è¯•é…ç½®æ•°æ®
        const testConfigs = [
            {
                name: "æœ‰æ•ˆçš„RSAé…ç½®",
                algorithm: "RSA",
                privateKey: {
                    value: "-----BEGIN PRIVATE KEY-----\nMIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBAKoYq6Q7UN7vOFmPr4fSq2NORXHB\nMKm8p7h4JnQU+quLRxvYll9cn8OBhIXq9SnCYkbzBVBkqN4ZyMM4vlSWy66wWdwLNYFDtEo1RJ6y\nZBExIaRVvX/eP6yRnpS1b7m7T2Uc2yPq1DnWzVI+sIGR51s1/ROnQZswkPJHh71PThlnAgMBAAEC\ngYEA45gzQLi7hAfVhRictua2AlY9gfLZmwQ4WzcJaYisqMZDuBoA1KUmga8sHM7HHftzsdc+7Ulv\n4nx4i3oAqxk7a13D7mB9E+z3H+w0ZupLxQuKjfV8V0vzEOMiOktTWmDdRF6XlQqpcdbt088Hnf7Y\n33gH3ZcQ5WwDHQz1KufyDzECQQDQ3D95c3r+woW5aG/te0AhdRDGRovARLXt6MFeK9hCDsYQzHpU\n8PoDm/oUg5OAFPCkp3ZxWRZFhZfx65d32mtFAkEAwHZPJA3OdXIrhK4bvJy5rR+hxWNn8jNhg0fT\n0Q8jdz87aD8NFjJi17AgbS7WQP7wHn7sDRrNLwGC7fbsDyO1CQJBAJw1oObdyRxmRqbU6LLkoeUM\nmGYwRHuC9k0HlWgF4WsiJHdk9v/gK1dXyGX6gtxJxaE0x3W4i9JlUVrkKZf3QUICQDFPJ988NBFs\nXOUK5CvwkWh7UdRYvJ7X6FN9bGM7zjGHvlgLKEJuacwqVx1DkCEc3h76ZYIgDlJ81s4j0dECQQCs\npG7VqXge3NjhP8SzC2G2A202R07rjd8pWWrcwFk9JtJvW4mZESxQZlKTbF4A2FZ9F7G0jvJXJeqm\n00ywl3J9\n-----END PRIVATE KEY-----",
                    encoding: ["UTF8"]
                }
            },
            {
                name: "æ— æ•ˆçš„RSAé…ç½®ï¼ˆç¼ºå°‘ç§é’¥å€¼ï¼‰",
                algorithm: "RSA",
                privateKey: {
                    // valueå­—æ®µä¸ºç©ºæˆ–ä¸å­˜åœ¨
                    encoding: ["UTF8"]
                }
            },
            {
                name: "æ— æ•ˆçš„RSAé…ç½®ï¼ˆç§é’¥å€¼ä¸ºç©ºï¼‰",
                algorithm: "RSA",
                privateKey: {
                    value: "",  // ç©ºå€¼
                    encoding: ["UTF8"]
                }
            },
            {
                name: "æœ‰æ•ˆçš„AESé…ç½®",
                algorithm: "AES/CBC/PKCS5Padding",
                key: {
                    value: "1234567890123456",
                    encoding: ["UTF8"]
                }
            },
            {
                name: "æ— æ•ˆçš„AESé…ç½®",
                algorithm: "AES/CBC/PKCS5Padding",
                key: {
                    // ç¼ºå°‘valueå­—æ®µ
                    encoding: ["UTF8"]
                }
            }
        ];

        function runValidationTests() {
            const resultsDiv = document.getElementById('validationResults');
            let html = '<h4>ğŸ“‹ é…ç½®éªŒè¯æµ‹è¯•ç»“æœ</h4>';
            
            testConfigs.forEach((config, index) => {
                const isNewValid = isValidConfig(config);
                const isOldValid = isValidConfigOld(config);
                const isConsistent = isNewValid === isOldValid;
                
                html += `
                    <div class="result-card ${isNewValid ? 'success' : 'error'}">
                        <h4>${index + 1}. ${config.name}</h4>
                        <div><strong>ç®—æ³•:</strong> ${config.algorithm}</div>
                        <div><strong>æ–°éªŒè¯ç»“æœ:</strong> ${isNewValid ? 'âœ… æœ‰æ•ˆ' : 'âŒ æ— æ•ˆ'}</div>
                        <div><strong>æ—§éªŒè¯ç»“æœ:</strong> ${isOldValid ? 'âœ… æœ‰æ•ˆ' : 'âŒ æ— æ•ˆ'}</div>
                        <div><strong>ç»“æœä¸€è‡´æ€§:</strong> ${isConsistent ? 'âœ… ä¸€è‡´' : 'âš ï¸ ä¸ä¸€è‡´'}</div>
                        ${!isConsistent ? `<div><strong>ä¿®å¤æ•ˆæœ:</strong> ${isNewValid && !isOldValid ? 'âœ… ä¿®å¤æˆåŠŸ' : 'âŒ ä»æœ‰é—®é¢˜'}</div>` : ''}
                    </div>
                `;
            });
            
            resultsDiv.innerHTML = html;
        }

        function testActualDecryption() {
            const resultsDiv = document.getElementById('validationResults');
            const testCipher = "A6zfp+TG4VH8Lf+xKISInZEcdc6klF5iS8kTzN1PktwE4cgEhzrbJ5dE6a/yrIoLZDIdxM6zmLzZe1h3u/YORrUTkxwusksnxzy9r7Uk3qKquR1zkBE9MdKP1BU5hkE9PP+g2EEnv+Wm46kf8MfPwohnKPnSNjCBdKskJ4fhNIpYh+2o5qqLmJhI7pvyjpr46d+2OQDSMv6xRhyRd+WsgzyudLYs8QiZrReqAQ09dDEyiJjyPrGPDGD2zsLjzHDpL6Eu9+mnGkugRYGPkgrScDySvijOoySr3nXeeimzayL61sIQ3Vjv9EvkQIQPvvHjqRonVGpfemitMuJWsUFDWw==";
            
            // æ¨¡æ‹Ÿè§£å¯†è¿‡ç¨‹
            html = `
                <div class="result-card info">
                    <h4>ğŸ”“ å®é™…è§£å¯†æµ‹è¯•</h4>
                    <div><strong>æµ‹è¯•å¯†æ–‡:</strong> ${testCipher.substring(0, 50)}...</div>
                    <div><strong>å¯†æ–‡é•¿åº¦:</strong> ${testCipher.length} å­—ç¬¦</div>
                    <div><strong>é¢„æœŸç»“æœ:</strong> åº”è¯¥èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«ä¸ºRSAå¯†æ–‡å¹¶è¿›è¡Œè§£å¯†</div>
                    <div><strong>ä¿®å¤éªŒè¯:</strong> ç¡®ä¿isValidConfigå‡½æ•°èƒ½æ­£ç¡®éªŒè¯RSAé…ç½®</div>
                </div>
            `;
            
            resultsDiv.innerHTML += html;
        }

        function testCustomConfig() {
            const configName = document.getElementById('configName').value;
            const privateKey = document.getElementById('privateKey').value;
            const resultsDiv = document.getElementById('customResults');
            
            const customConfig = {
                name: configName,
                algorithm: "RSA",
                privateKey: {
                    value: privateKey,
                    encoding: ["UTF8"]
                }
            };
            
            const isValid = isValidConfig(customConfig);
            
            resultsDiv.innerHTML = `
                <div class="result-card ${isValid ? 'success' : 'error'}">
                    <h4>ğŸ§ª è‡ªå®šä¹‰é…ç½®æµ‹è¯•</h4>
                    <div><strong>é…ç½®åç§°:</strong> ${configName}</div>
                    <div><strong>ç§é’¥é•¿åº¦:</strong> ${privateKey.length} å­—ç¬¦</div>
                    <div><strong>éªŒè¯ç»“æœ:</strong> ${isValid ? 'âœ… æœ‰æ•ˆé…ç½®' : 'âŒ æ— æ•ˆé…ç½®'}</div>
                    <div><strong>å¯ç”¨äºè§£å¯†:</strong> ${isValid ? 'æ˜¯' : 'å¦'}</div>
                </div>
            `;
        }

        function clearResults() {
            document.getElementById('validationResults').innerHTML = '';
            document.getElementById('customResults').innerHTML = '';
        }

        // é¡µé¢åŠ è½½æ—¶è¿è¡Œåˆå§‹æµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            runValidationTests();
        });
    </script>
</body>
</html>