<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSAå¯†æ–‡è¯†åˆ«ä¿®å¤éªŒè¯</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 25px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            background-color: #ffffff;
        }
        .result-card {
            margin: 15px 0;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 14px;
        }
        .success { background-color: #d4edda; border-left: 4px solid #28a745; }
        .error { background-color: #f8d7da; border-left: 4px solid #dc3545; }
        .warning { background-color: #fff3cd; border-left: 4px solid #ffc107; }
        .info { background-color: #d1ecf1; border-left: 4px solid #17a2b8; }
        textarea, input { 
            width: 100%; 
            padding: 10px; 
            margin: 8px 0; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
            font-family: monospace;
        }
        button {
            padding: 12px 24px;
            margin: 5px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 16px;
        }
        button:hover { background: #0056b3; }
        button.secondary { background: #6c757d; }
        button.secondary:hover { background: #545b62; }
        button.success { background: #28a745; }
        button.success:hover { background: #1e7e34; }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            background-color: #f8f9fa;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 14px;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ RSAå¯†æ–‡è¯†åˆ«ä¿®å¤éªŒè¯</h1>
        <p>éªŒè¯æ–°å¢çš„RSAå¯†æ–‡ç‰¹æ®Šæ£€æµ‹åŠŸèƒ½æ˜¯å¦èƒ½æ­£ç¡®è¯†åˆ«ç”¨æˆ·æä¾›çš„RSAå¯†æ–‡</p>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalTests">0</div>
                <div class="stat-label">æ€»æµ‹è¯•æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="passedTests" style="color: #28a745;">0</div>
                <div class="stat-label">é€šè¿‡æµ‹è¯•</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="failedTests" style="color: #dc3545;">0</div>
                <div class="stat-label">å¤±è´¥æµ‹è¯•</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="successRate">0%</div>
                <div class="stat-label">æˆåŠŸç‡</div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ æ ¸å¿ƒæµ‹è¯•ï¼šç”¨æˆ·æä¾›çš„RSAå¯†æ–‡</h3>
            <div class="info">
                <strong>æµ‹è¯•å¯†æ–‡:</strong><br>
                <small>A6zfp+TG4VH8Lf+xKISInZEcdc6klF5iS8kTzN1PktwE4cgEhzrbJ5dE6a/yrIoLZDIdxM6zmLzZe1h3u/YORrUTkxwusksnxzy9r7Uk3qKquR1zkBE9MdKP1BU5hkE9PP+g2EEnv+Wm46kf8MfPwohnKPnSNjCBdKskJ4fhNIpYh+2o5qqLmJhI7pvyjpr46d+2OQDSMv6xRhyRd+WsgzyudLYs8QiZrReqAQ09dDEyiJjyPrGPDGD2zsLjzHDpL6Eu9+mnGkugRYGPkgrScDySvijOoySr3nXeeimzayL61sIQ3Vjv9EvkQIQPvvHjqRonVGpfemitMuJWsUFDWw==</small>
            </div>
            <button onclick="testUserRSACipher()">ğŸ”¬ æµ‹è¯•è¯†åˆ«</button>
            <div id="userRSAResult"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“‹ ç»¼åˆæµ‹è¯•å¥—ä»¶</h3>
            <button onclick="runComprehensiveTest()">ğŸš€ è¿è¡Œç»¼åˆæµ‹è¯•</button>
            <button class="secondary" onclick="runEdgeCaseTest()">âš ï¸ è¾¹ç•Œæƒ…å†µæµ‹è¯•</button>
            <button class="success" onclick="clearAllResults()">ğŸ—‘ï¸ æ¸…ç©ºç»“æœ</button>
            <div id="comprehensiveResults"></div>
        </div>

        <div class="test-section">
            <h3>âš™ï¸ è‡ªå®šä¹‰æµ‹è¯•</h3>
            <textarea id="customInput" placeholder="è¾“å…¥è¦æµ‹è¯•çš„å†…å®¹...">A6zfp+TG4VH8Lf+xKISInZEcdc6klF5iS8kTzN1PktwE4cgEhzrbJ5dE6a/yrIoLZDIdxM6zmLzZe1h3u/YORrUTkxwusksnxzy9r7Uk3qKquR1zkBE9MdKP1BU5hkE9PP+g2EEnv+Wm46kf8MfPwohnKPnSNjCBdKskJ4fhNIpYh+2o5qqLmJhI7pvyjpr46d+2OQDSMv6xRhyRd+WsgzyudLYs8QiZrReqAQ09dDEyiJjyPrGPDGD2zsLjzHDpL6Eu9+mnGkugRYGPkgrScDySvijOoySr3nXeeimzayL61sIQ3Vjv9EvkQIQPvvHjqRonVGpfemitMuJWsUFDWw==</textarea>
            <button onclick="testCustomInput()">ğŸ§ª æµ‹è¯•è‡ªå®šä¹‰è¾“å…¥</button>
            <div id="customResult"></div>
        </div>
    </div>

    <script>
        // æµ‹è¯•ç»Ÿè®¡æ•°æ®
        let testStats = {
            total: 0,
            passed: 0,
            failed: 0
        };

        // RSAå¯†æ–‡ç‰¹å¾æ£€æµ‹å‡½æ•°ï¼ˆæ¨¡æ‹Ÿä¿®å¤åçš„é€»è¾‘ï¼‰
        async function isLikelyRSACipher(content) {
            const trimmedContent = content.trim();
            
            console.log('RSAæ£€æµ‹è¾“å…¥:', trimmedContent.substring(0, 50) + '...');
            console.log('è¾“å…¥é•¿åº¦:', trimmedContent.length);
            
            // åŸºæœ¬æ ¼å¼æ£€æŸ¥ - å¿…é¡»æ˜¯æœ‰æ•ˆçš„Base64
            const base64Pattern = /^[A-Za-z0-9+/]*={0,2}$/;
            if (!base64Pattern.test(trimmedContent)) {
                console.log('âŒ ä¸æ˜¯æœ‰æ•ˆçš„Base64æ ¼å¼');
                return false;
            }

            // é•¿åº¦æ£€æŸ¥ - RSAåŠ å¯†ç»“æœé€šå¸¸è¾ƒé•¿
            if (trimmedContent.length < 50) {
                console.log('âŒ é•¿åº¦å¤ªçŸ­ï¼Œä¸æ˜¯RSAå¯†æ–‡');
                return false;
            }

            // é•¿åº¦ç‰¹å¾æ£€æŸ¥ - RSAå¸¸è§é•¿åº¦
            const typicalRSALengths = [344, 172, 256, 128];
            const isTypicalLength = typicalRSALengths.includes(trimmedContent.length);
            
            console.log('é•¿åº¦æ£€æŸ¥:', {
                actualLength: trimmedContent.length,
                isTypicalLength: isTypicalLength,
                typicalLengths: typicalRSALengths
            });

            // æ¨¡æ‹Ÿæ£€æŸ¥æ˜¯å¦å­˜åœ¨RSAé…ç½®ï¼ˆè¿™é‡Œå‡è®¾å­˜åœ¨ï¼‰
            const hasRSAConfig = true; // åœ¨å®é™…åº”ç”¨ä¸­ä¼šæ£€æŸ¥å­˜å‚¨é…ç½®
            
            // å¦‚æœæœ‰RSAé…ç½®ä¸”é•¿åº¦ç¬¦åˆç‰¹å¾ï¼Œåˆ™å¾ˆå¯èƒ½æ˜¯RSAå¯†æ–‡
            if (hasRSAConfig && (isTypicalLength || trimmedContent.length > 100)) {
                console.log('âœ… æ£€æµ‹åˆ°RSAå¯†æ–‡ç‰¹å¾');
                return true;
            }
            
            console.log('âŒ ä¸ç¬¦åˆRSAå¯†æ–‡ç‰¹å¾');
            return false;
        }

        // å†…å®¹ç±»å‹æ£€æµ‹å‡½æ•°ï¼ˆç®€åŒ–ç‰ˆï¼‰
        async function detectContentType(content) {
            const trimmedContent = content?.trim() || '';

            // RSAå¯†æ–‡ç‰¹æ®Šæ£€æµ‹
            if (await isLikelyRSACipher(trimmedContent)) {
                return 'encrypted';
            }

            // å…¶ä»–æ£€æµ‹é€»è¾‘...
            const base64Pattern = /^[A-Za-z0-9+/]*={0,2}$/;
            if (base64Pattern.test(trimmedContent) && trimmedContent.length % 4 === 0 && trimmedContent.length > 10) {
                return 'encode';
            }

            return 'encode';
        }

        // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
        function updateStats() {
            document.getElementById('totalTests').textContent = testStats.total;
            document.getElementById('passedTests').textContent = testStats.passed;
            document.getElementById('failedTests').textContent = testStats.failed;
            
            const successRate = testStats.total > 0 ? Math.round((testStats.passed / testStats.total) * 100) : 0;
            document.getElementById('successRate').textContent = `${successRate}%`;
        }

        // æµ‹è¯•ç”¨æˆ·æä¾›çš„RSAå¯†æ–‡
        async function testUserRSACipher() {
            const userCipher = "A6zfp+TG4VH8Lf+xKISInZEcdc6klF5iS8kTzN1PktwE4cgEhzrbJ5dE6a/yrIoLZDIdxM6zmLzZe1h3u/YORrUTkxwusksnxzy9r7Uk3qKquR1zkBE9MdKP1BU5hkE9PP+g2EEnv+Wm46kf8MfPwohnKPnSNjCBdKskJ4fhNIpYh+2o5qqLmJhI7pvyjpr46d+2OQDSMv6xRhyRd+WsgzyudLYs8QiZrReqAQ09dDEyiJjyPrGPDGD2zsLjzHDpL6Eu9+mnGkugRYGPkgrScDySvijOoySr3nXeeimzayL61sIQ3Vjv9EvkQIQPvvHjqRonVGpfemitMuJWsUFDWw==";
            
            testStats.total++;
            const resultDiv = document.getElementById('userRSAResult');
            
            try {
                const result = await detectContentType(userCipher);
                const isSuccess = result === 'encrypted';
                
                if (isSuccess) {
                    testStats.passed++;
                } else {
                    testStats.failed++;
                }
                
                resultDiv.innerHTML = `
                    <div class="result-card ${isSuccess ? 'success' : 'error'}">
                        <h4>ğŸ“Š æµ‹è¯•ç»“æœ</h4>
                        <div><strong>æ£€æµ‹ç»“æœ:</strong> ${result}</div>
                        <div><strong>é¢„æœŸç»“æœ:</strong> encrypted</div>
                        <div><strong>æµ‹è¯•çŠ¶æ€:</strong> ${isSuccess ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'}</div>
                        <div><strong>å¯†æ–‡é•¿åº¦:</strong> ${userCipher.length} å­—ç¬¦</div>
                        <div><strong>æ˜¯å¦å…¸å‹RSAé•¿åº¦:</strong> ${[344, 172, 256, 128].includes(userCipher.length) ? 'æ˜¯' : 'å¦'}</div>
                    </div>
                `;
            } catch (error) {
                testStats.failed++;
                resultDiv.innerHTML = `
                    <div class="result-card error">
                        <h4>âŒ æµ‹è¯•é”™è¯¯</h4>
                        <div><strong>é”™è¯¯ä¿¡æ¯:</strong> ${error.message}</div>
                    </div>
                `;
            }
            
            updateStats();
        }

        // è¿è¡Œç»¼åˆæµ‹è¯•
        async function runComprehensiveTest() {
            const testCases = [
                {
                    name: "ç”¨æˆ·RSAå¯†æ–‡",
                    content: "A6zfp+TG4VH8Lf+xKISInZEcdc6klF5iS8kTzN1PktwE4cgEhzrbJ5dE6a/yrIoLZDIdxM6zmLzZe1h3u/YORrUTkxwusksnxzy9r7Uk3qKquR1zkBE9MdKP1BU5hkE9PP+g2EEnv+Wm46kf8MfPwohnKPnSNjCBdKskJ4fhNIpYh+2o5qqLmJhI7pvyjpr46d+2OQDSMv6xRhyRd+WsgzyudLYs8QiZrReqAQ09dDEyiJjyPrGPDGD2zsLjzHDpL6Eu9+mnGkugRYGPkgrScDySvijOoySr3nXeeimzayL61sIQ3Vjv9EvkQIQPvvHjqRonVGpfemitMuJWsUFDWw==",
                    expected: "encrypted"
                },
                {
                    name: "æ™®é€šBase64ç¼–ç ",
                    content: "SGVsbG8gV29ybGQhIOS9oOWlve+8geS4lueVjO+8gQ==",
                    expected: "encode"
                },
                {
                    name: "çŸ­æ–‡æœ¬",
                    content: "Hello",
                    expected: "encode"
                },
                {
                    name: "æ— æ•ˆBase64",
                    content: "Hello World! è¿™ä¸æ˜¯Base64",
                    expected: "encode"
                },
                {
                    name: "è¾ƒçŸ­çš„Base64",
                    content: "SGVsbG8=",
                    expected: "encode"
                }
            ];
            
            const resultsDiv = document.getElementById('comprehensiveResults');
            let resultsHtml = '<h4>ğŸ“‹ ç»¼åˆæµ‹è¯•ç»“æœ</h4>';
            
            for (const testCase of testCases) {
                testStats.total++;
                try {
                    const result = await detectContentType(testCase.content);
                    const isSuccess = result === testCase.expected;
                    
                    if (isSuccess) {
                        testStats.passed++;
                    } else {
                        testStats.failed++;
                    }
                    
                    resultsHtml += `
                        <div class="result-card ${isSuccess ? 'success' : 'error'}">
                            <h4>${isSuccess ? 'âœ…' : 'âŒ'} ${testCase.name}</h4>
                            <div><strong>è¾“å…¥:</strong> ${testCase.content.substring(0, 30)}${testCase.content.length > 30 ? '...' : ''}</div>
                            <div><strong>é•¿åº¦:</strong> ${testCase.content.length} å­—ç¬¦</div>
                            <div><strong>æ£€æµ‹ç»“æœ:</strong> ${result}</div>
                            <div><strong>é¢„æœŸç»“æœ:</strong> ${testCase.expected}</div>
                            <div><strong>æµ‹è¯•çŠ¶æ€:</strong> ${isSuccess ? 'é€šè¿‡' : 'å¤±è´¥'}</div>
                        </div>
                    `;
                } catch (error) {
                    testStats.failed++;
                    resultsHtml += `
                        <div class="result-card error">
                            <h4>âŒ ${testCase.name} - æ‰§è¡Œé”™è¯¯</h4>
                            <div><strong>é”™è¯¯ä¿¡æ¯:</strong> ${error.message}</div>
                        </div>
                    `;
                }
            }
            
            resultsDiv.innerHTML = resultsHtml;
            updateStats();
        }

        // è¾¹ç•Œæƒ…å†µæµ‹è¯•
        async function runEdgeCaseTest() {
            const edgeCases = [
                {
                    name: "æ°å¥½50å­—ç¬¦çš„Base64",
                    content: "A".repeat(50),
                    description: "åˆšå¥½æ»¡è¶³æœ€å°é•¿åº¦è¦æ±‚"
                },
                {
                    name: "100å­—ç¬¦çš„Base64",
                    content: "A".repeat(100),
                    description: "è¶…è¿‡æœ€å°é•¿åº¦ä½†ä¸æ˜¯å…¸å‹RSAé•¿åº¦"
                },
                {
                    name: "åŒ…å«éæ³•å­—ç¬¦",
                    content: "A6zfp+TG4VH8Lf+xKISInZEcdc6klF5iS8kTzN1PktwE4cgEh!!!",
                    description: "Base64æ ¼å¼è¢«ç ´å"
                },
                {
                    name: "ç©ºå­—ç¬¦ä¸²",
                    content: "",
                    description: "è¾¹ç•Œæƒ…å†µ"
                }
            ];
            
            const resultsDiv = document.getElementById('comprehensiveResults');
            let resultsHtml = '<h4>âš ï¸ è¾¹ç•Œæƒ…å†µæµ‹è¯•</h4>';
            
            for (const testCase of edgeCases) {
                testStats.total++;
                try {
                    const isRSACipher = await isLikelyRSACipher(testCase.content);
                    const result = isRSACipher ? 'encrypted' : 'encode';
                    
                    // è¾¹ç•Œæƒ…å†µé¢„æœŸéƒ½æ˜¯false
                    const isSuccess = !isRSACipher;
                    
                    if (isSuccess) {
                        testStats.passed++;
                    } else {
                        testStats.failed++;
                    }
                    
                    resultsHtml += `
                        <div class="result-card ${isSuccess ? 'success' : 'warning'}">
                            <h4>${isSuccess ? 'âœ…' : 'âš ï¸'} ${testCase.name}</h4>
                            <div><strong>æè¿°:</strong> ${testCase.description}</div>
                            <div><strong>è¾“å…¥é•¿åº¦:</strong> ${testCase.content.length} å­—ç¬¦</div>
                            <div><strong>æ˜¯å¦è¯†åˆ«ä¸ºRSA:</strong> ${isRSACipher ? 'æ˜¯' : 'å¦'}</div>
                            <div><strong>æµ‹è¯•çŠ¶æ€:</strong> ${isSuccess ? 'æ­£ç¡®å¤„ç†' : 'æ„å¤–è¯†åˆ«'}</div>
                        </div>
                    `;
                } catch (error) {
                    testStats.failed++;
                    resultsHtml += `
                        <div class="result-card error">
                            <h4>âŒ ${testCase.name} - æ‰§è¡Œé”™è¯¯</h4>
                            <div><strong>é”™è¯¯ä¿¡æ¯:</strong> ${error.message}</div>
                        </div>
                    `;
                }
            }
            
            resultsDiv.innerHTML = resultsHtml;
            updateStats();
        }

        // æµ‹è¯•è‡ªå®šä¹‰è¾“å…¥
        async function testCustomInput() {
            const customContent = document.getElementById('customInput').value;
            const resultDiv = document.getElementById('customResult');
            
            if (!customContent.trim()) {
                resultDiv.innerHTML = '<div class="result-card warning">è¯·è¾“å…¥æµ‹è¯•å†…å®¹</div>';
                return;
            }
            
            testStats.total++;
            
            try {
                const result = await detectContentType(customContent);
                const isRSACipher = await isLikelyRSACipher(customContent);
                
                const isEncrypted = result === 'encrypted';
                const isSuccess = isEncrypted === isRSACipher;
                
                if (isSuccess) {
                    testStats.passed++;
                } else {
                    testStats.failed++;
                }
                
                resultDiv.innerHTML = `
                    <div class="result-card ${isSuccess ? 'success' : 'info'}">
                        <h4>ğŸ”¬ è‡ªå®šä¹‰æµ‹è¯•ç»“æœ</h4>
                        <div><strong>è¾“å…¥å†…å®¹:</strong> ${customContent.substring(0, 50)}${customContent.length > 50 ? '...' : ''}</div>
                        <div><strong>å†…å®¹é•¿åº¦:</strong> ${customContent.length} å­—ç¬¦</div>
                        <div><strong>å†…å®¹ç±»å‹æ£€æµ‹:</strong> ${result}</div>
                        <div><strong>RSAç‰¹å¾æ£€æµ‹:</strong> ${isRSACipher ? 'æ˜¯RSAå¯†æ–‡' : 'ä¸æ˜¯RSAå¯†æ–‡'}</div>
                        <div><strong>ä¸€è‡´æ€§æ£€æŸ¥:</strong> ${isSuccess ? 'âœ… ä¸€è‡´' : 'âŒ ä¸ä¸€è‡´'}</div>
                    </div>
                `;
            } catch (error) {
                testStats.failed++;
                resultDiv.innerHTML = `
                    <div class="result-card error">
                        <h4>âŒ æµ‹è¯•é”™è¯¯</h4>
                        <div><strong>é”™è¯¯ä¿¡æ¯:</strong> ${error.message}</div>
                    </div>
                `;
            }
            
            updateStats();
        }

        // æ¸…ç©ºæ‰€æœ‰ç»“æœ
        function clearAllResults() {
            document.getElementById('userRSAResult').innerHTML = '';
            document.getElementById('comprehensiveResults').innerHTML = '';
            document.getElementById('customResult').innerHTML = '';
            
            testStats = { total: 0, passed: 0, failed: 0 };
            updateStats();
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
        });
    </script>
</body>
</html>