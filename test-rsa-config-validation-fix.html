<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSAé…ç½®éªŒè¯ä¿®å¤æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-6 text-center">ğŸ” RSAé…ç½®éªŒè¯ä¿®å¤æµ‹è¯•</h1>
        
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">é—®é¢˜æè¿°</h2>
            <div class="bg-red-50 border border-red-200 rounded p-4 mb-4">
                <p class="text-red-800"><strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> RSAè§£å¯†éœ€è¦æä¾›ç§é’¥</p>
                <p class="text-red-700 mt-2"><strong>é”™è¯¯ä½ç½®ï¼š</strong> cipherutils.js:325:13</p>
            </div>
            
            <div class="bg-blue-50 border border-blue-200 rounded p-4">
                <h3 class="font-medium text-blue-800 mb-2">æ ¹æœ¬åŸå› ï¼š</h3>
                <p class="text-blue-700">AutoCipherToolç»„ä»¶ä¸­çš„isValidConfigå‡½æ•°éªŒè¯é€»è¾‘ä¸å®Œæ•´ï¼Œåªæ£€æŸ¥äº†config.privateKeyå¯¹è±¡æ˜¯å¦å­˜åœ¨ï¼Œè€Œæ²¡æœ‰æ£€æŸ¥config.privateKey.valueæ˜¯å¦å­˜åœ¨ä¸”éç©ºã€‚</p>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- ä¿®å¤å‰ä»£ç  -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4 text-red-600">âŒ ä¿®å¤å‰ï¼ˆé”™è¯¯ä»£ç ï¼‰</h2>
                <pre class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"><code>// éªŒè¯é…ç½®æ˜¯å¦æœ‰æ•ˆ
const isValidConfig = (config) => {
  if (!config || !config.name) return false;
  if (config.algorithm?.startsWith('RSA')) {
    // âŒ é”™è¯¯ï¼šåªæ£€æŸ¥å¯¹è±¡å­˜åœ¨ï¼Œä¸æ£€æŸ¥å€¼æ˜¯å¦å­˜åœ¨
    return config.privateKey;  // å¯èƒ½æ˜¯ {} ç©ºå¯¹è±¡
  } else {
    return config.key && config.key.value;
  }
};</code></pre>
                
                <div class="mt-4 p-3 bg-red-50 rounded">
                    <p class="text-red-700 text-sm"><strong>é—®é¢˜ï¼š</strong>å³ä½¿config.privateKeyæ˜¯ç©ºå¯¹è±¡{}ï¼Œä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆé…ç½®ï¼Œå¯¼è‡´åç»­è§£å¯†æ—¶å‡ºç°"éœ€è¦æä¾›ç§é’¥"é”™è¯¯ã€‚</p>
                </div>
            </div>

            <!-- ä¿®å¤åä»£ç  -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4 text-green-600">âœ… ä¿®å¤åï¼ˆæ­£ç¡®ä»£ç ï¼‰</h2>
                <pre class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"><code>// éªŒè¯é…ç½®æ˜¯å¦æœ‰æ•ˆ
const isValidConfig = (config) => {
  if (!config || !config.name) return false;
  if (config.algorithm?.startsWith('RSA')) {
    // âœ… æ­£ç¡®ï¼šåŒæ—¶æ£€æŸ¥å¯¹è±¡å’Œå€¼çš„å­˜åœ¨
    return config.privateKey && config.privateKey.value;
  } else {
    return config.key && config.key.value;
  }
};</code></pre>
                
                <div class="mt-4 p-3 bg-green-50 rounded">
                    <p class="text-green-700 text-sm"><strong>æ”¹è¿›ï¼š</strong>åªæœ‰å½“config.privateKeyå¯¹è±¡å­˜åœ¨ä¸”å…¶valueå±æ€§æœ‰å®é™…å€¼æ—¶ï¼Œæ‰è®¤ä¸ºæ˜¯æœ‰æ•ˆé…ç½®ã€‚</p>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
            <h2 class="text-xl font-semibold mb-4">ğŸ§ª é…ç½®éªŒè¯æµ‹è¯•</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-medium mb-3">æµ‹è¯•ç”¨ä¾‹</h3>
                    <div class="space-y-4">
                        <div class="border rounded p-3">
                            <h4 class="font-medium text-sm mb-2">æœ‰æ•ˆRSAé…ç½®</h4>
                            <pre class="bg-gray-100 p-2 rounded text-xs">{
  name: "rsa-test",
  algorithm: "RSA",
  privateKey: {
    value: "-----BEGIN PRIVATE KEY-----...",
    encoding: ["UTF8"]
  }
}</pre>
                        </div>
                        
                        <div class="border rounded p-3">
                            <h4 class="font-medium text-sm mb-2">æ— æ•ˆRSAé…ç½®ï¼ˆç©ºå€¼ï¼‰</h4>
                            <pre class="bg-gray-100 p-2 rounded text-xs">{
  name: "rsa-invalid",
  algorithm: "RSA",
  privateKey: {
    value: "",  // ç©ºå€¼
    encoding: ["UTF8"]
  }
}</pre>
                        </div>
                        
                        <div class="border rounded p-3">
                            <h4 class="font-medium text-sm mb-2">æ— æ•ˆRSAé…ç½®ï¼ˆæ— å€¼å±æ€§ï¼‰</h4>
                            <pre class="bg-gray-100 p-2 rounded text-xs">{
  name: "rsa-invalid2",
  algorithm: "RSA",
  privateKey: {}  // ç©ºå¯¹è±¡ï¼Œæ— valueå±æ€§
}</pre>
                        </div>
                        
                        <button onclick="runValidationTests()" 
                                class="w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded">
                            ğŸ”§ è¿è¡ŒéªŒè¯æµ‹è¯•
                        </button>
                    </div>
                </div>
                
                <div>
                    <h3 class="font-medium mb-3">æµ‹è¯•ç»“æœ</h3>
                    <div id="validationResults" class="bg-gray-50 p-4 rounded min-h-[300px]">
                        <p class="text-gray-500">ç‚¹å‡»"è¿è¡ŒéªŒè¯æµ‹è¯•"æŒ‰é’®å¼€å§‹æµ‹è¯•...</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
            <h2 class="text-xl font-semibold mb-4">ğŸ“‹ ä¿®å¤æ€»ç»“</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="p-4 bg-green-50 rounded-lg">
                    <h3 class="font-medium text-green-800 mb-2">âœ… é—®é¢˜ä¿®å¤</h3>
                    <ul class="text-sm text-green-700 space-y-1">
                        <li>ä¿®æ­£RSAé…ç½®éªŒè¯é€»è¾‘</li>
                        <li>åŠ å¼ºç§é’¥å€¼å­˜åœ¨æ€§æ£€æŸ¥</li>
                        <li>é¿å…ç©ºé…ç½®å¯¼è‡´çš„è¿è¡Œæ—¶é”™è¯¯</li>
                    </ul>
                </div>
                <div class="p-4 bg-blue-50 rounded-lg">
                    <h3 class="font-medium text-blue-800 mb-2">ğŸ”§ æŠ€æœ¯è¦ç‚¹</h3>
                    <ul class="text-sm text-blue-700 space-y-1">
                        <li>é…ç½®ç»“æ„ï¼š<code>{privateKey: {value, encoding}}</code></li>
                        <li>åŒé‡éªŒè¯ï¼š<code>config.privateKey && config.privateKey.value</code></li>
                        <li>é˜²æ­¢ç©ºå¯¹è±¡è¯¯åˆ¤ä¸ºæœ‰æ•ˆé…ç½®</li>
                    </ul>
                </div>
                <div class="p-4 bg-purple-50 rounded-lg">
                    <h3 class="font-medium text-purple-800 mb-2">ğŸ¯ å½±å“èŒƒå›´</h3>
                    <ul class="text-sm text-purple-700 space-y-1">
                        <li>AutoCipherToolè‡ªåŠ¨è§£å¯†åŠŸèƒ½</li>
                        <li>RSAé…ç½®çš„æœ‰æ•ˆæ€§éªŒè¯</li>
                        <li>è§£å¯†å‰çš„é…ç½®ç­›é€‰æœºåˆ¶</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿä¿®å¤åçš„isValidConfigå‡½æ•°
        function isValidConfig(config) {
            if (!config || !config.name) return false;
            if (config.algorithm?.startsWith('RSA')) {
                // ä¿®å¤ï¼šåŒæ—¶æ£€æŸ¥å¯¹è±¡å’Œå€¼çš„å­˜åœ¨
                return config.privateKey && config.privateKey.value;
            } else {
                return config.key && config.key.value;
            }
        }

        // è¿è¡ŒéªŒè¯æµ‹è¯•
        function runValidationTests() {
            const resultsDiv = document.getElementById('validationResults');
            
            // æµ‹è¯•ç”¨ä¾‹
            const testCases = [
                {
                    name: "æœ‰æ•ˆRSAé…ç½®",
                    config: {
                        name: "rsa-valid",
                        algorithm: "RSA",
                        privateKey: {
                            value: "-----BEGIN PRIVATE KEY-----MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...",
                            encoding: ["UTF8"]
                        }
                    },
                    expected: true
                },
                {
                    name: "æ— æ•ˆRSAé…ç½®ï¼ˆç©ºå€¼ï¼‰",
                    config: {
                        name: "rsa-invalid-empty",
                        algorithm: "RSA",
                        privateKey: {
                            value: "",
                            encoding: ["UTF8"]
                        }
                    },
                    expected: false
                },
                {
                    name: "æ— æ•ˆRSAé…ç½®ï¼ˆæ— å€¼å±æ€§ï¼‰",
                    config: {
                        name: "rsa-invalid-no-value",
                        algorithm: "RSA",
                        privateKey: {}
                    },
                    expected: false
                },
                {
                    name: "æœ‰æ•ˆAESé…ç½®",
                    config: {
                        name: "aes-valid",
                        algorithm: "AES/CBC/PKCS5Padding",
                        key: {
                            value: "1234567890123456",
                            encoding: ["UTF8"]
                        }
                    },
                    expected: true
                },
                {
                    name: "æ— æ•ˆAESé…ç½®",
                    config: {
                        name: "aes-invalid",
                        algorithm: "AES/CBC/PKCS5Padding",
                        key: {
                            value: "",
                            encoding: ["UTF8"]
                        }
                    },
                    expected: false
                }
            ];

            let resultsHtml = '<div class="space-y-3">';
            
            testCases.forEach((testCase, index) => {
                const isValid = isValidConfig(testCase.config);
                const isCorrect = isValid === testCase.expected;
                
                resultsHtml += `
                    <div class="p-3 rounded ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-red-50 border border-red-200'}">
                        <div class="flex items-center justify-between">
                            <span class="font-medium ${isCorrect ? 'text-green-800' : 'text-red-800'}">
                                ${testCase.name}
                            </span>
                            <span class="text-sm ${isCorrect ? 'text-green-600' : 'text-red-600'}">
                                ${isValid ? 'âœ… æœ‰æ•ˆ' : 'âŒ æ— æ•ˆ'} ${isCorrect ? '(âœ“ æ­£ç¡®)' : '(âœ— é”™è¯¯)'}
                            </span>
                        </div>
                        <div class="mt-2 text-xs text-gray-600">
                            <div><strong>æœŸæœ›ç»“æœï¼š</strong> ${testCase.expected ? 'æœ‰æ•ˆ' : 'æ— æ•ˆ'}</div>
                            <div><strong>å®é™…ç»“æœï¼š</strong> ${isValid ? 'æœ‰æ•ˆ' : 'æ— æ•ˆ'}</div>
                        </div>
                    </div>
                `;
            });
            
            resultsHtml += '</div>';
            resultsDiv.innerHTML = resultsHtml;
        }
    </script>
</body>
</html>